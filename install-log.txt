Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (3.1.0)
Requirement already satisfied: ninja in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (1.11.1)
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (1.24.3)
Requirement already satisfied: packaging>=20.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (23.1)
Requirement already satisfied: psutil in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (1.10.12)
Requirement already satisfied: torch in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (2.0.1)
Requirement already satisfied: tqdm in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+f8d3ec7f) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+f8d3ec7f) (4.7.1)
Requirement already satisfied: filelock in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from torch->deepspeed==0.10.4+f8d3ec7f) (3.12.3)
Requirement already satisfied: sympy in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from torch->deepspeed==0.10.4+f8d3ec7f) (1.12)
Requirement already satisfied: networkx in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from torch->deepspeed==0.10.4+f8d3ec7f) (3.1)
Requirement already satisfied: jinja2 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from torch->deepspeed==0.10.4+f8d3ec7f) (3.1.2)
Requirement already satisfied: MarkupSafe>=2.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from jinja2->torch->deepspeed==0.10.4+f8d3ec7f) (2.1.3)
Requirement already satisfied: mpmath>=0.19 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from sympy->torch->deepspeed==0.10.4+f8d3ec7f) (1.3.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+f8d3ec7f-cp310-cp310-linux_x86_64.whl size=63670501 sha256=f007bd857fe758cfcfc72f4080250f5f1e46941fc8d72196116d56ee2bd88532
  Stored in directory: /tmp/pip-ephem-wheel-cache-kk5_a16u/wheels/12/1d/ee/3780de8984f5774257085fe92ec89f10a6b1a5d2beabc12020
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+f8d3ec7f
    Uninstalling deepspeed-0.10.4+f8d3ec7f:
      Successfully uninstalled deepspeed-0.10.4+f8d3ec7f
Successfully installed deepspeed-0.10.4+f8d3ec7f
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting hjson (from deepspeed==0.10.4+e78a15ed)
  Downloading hjson-3.1.0.tar.gz (40 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.5/40.5 kB 88.3 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting ninja (from deepspeed==0.10.4+e78a15ed)
  Downloading ninja-1.11.1.tar.gz (27 kB)
  Installing build dependencies: started
  Installing build dependencies: still running...
  Installing build dependencies: still running...
  Installing build dependencies: still running...
  Installing build dependencies: still running...
  Installing build dependencies: still running...
  Installing build dependencies: still running...
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Collecting packaging>=20.0 (from deepspeed==0.10.4+e78a15ed)
  Downloading packaging-23.2.tar.gz (146 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 146.7/146.7 kB 48.9 MB/s eta 0:00:00
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting psutil (from deepspeed==0.10.4+e78a15ed)
  Downloading psutil-5.9.5.tar.gz (493 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 493.5/493.5 kB 116.0 MB/s eta 0:00:00
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting py-cpuinfo (from deepspeed==0.10.4+e78a15ed)
  Downloading py-cpuinfo-9.0.0.tar.gz (104 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 104.7/104.7 kB 207.0 MB/s eta 0:00:00
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Collecting pydantic<2.0.0 (from deepspeed==0.10.4+e78a15ed)
  Downloading pydantic-1.10.13.tar.gz (348 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 348.3/348.3 kB 238.2 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting tqdm (from deepspeed==0.10.4+e78a15ed)
  Downloading tqdm-4.66.1.tar.gz (169 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 169.1/169.1 kB 233.3 MB/s eta 0:00:00
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed, packaging, pydantic, hjson, ninja, psutil, py-cpuinfo, tqdm
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440348 sha256=21c84a28faf5633d55c3d74de28447914deca13e82125e0da2dd9fd5b31b095b
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
  Building wheel for packaging (pyproject.toml): started
  Building wheel for packaging (pyproject.toml): finished with status 'done'
  Created wheel for packaging: filename=packaging-23.2-py3-none-any.whl size=53011 sha256=f6a99fc6f2edcd10c7194f27328f1dd5e1a04d24720927bcf0879d6166868a62
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/82/8d/90/d7ce847a84ad13e6ef7bc77c90ab3c82db46eea2687ab243bb
  Building wheel for pydantic (setup.py): started
  Building wheel for pydantic (setup.py): finished with status 'done'
  Created wheel for pydantic: filename=pydantic-1.10.13-py3-none-any.whl size=158608 sha256=65f1e75a5721473c1176b0b75f9e3761890214c03f1f40fadcf396f9fce8177c
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/9a/75/5d/994a9b6006fc7a6cca7b1213278200564957a4bb3bb681538d
  Building wheel for hjson (setup.py): started
  Building wheel for hjson (setup.py): finished with status 'done'
  Created wheel for hjson: filename=hjson-3.1.0-py3-none-any.whl size=54018 sha256=43fc9c7d119a941a66997e33df056522da63a7fa8389f51e516773e1c63490e1
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/6c/d0/f7/31b7b04c4e42ecea4f69520870a8421be8a166f8e0b2d9ab92
  Building wheel for ninja (pyproject.toml): started
  Building wheel for ninja (pyproject.toml): finished with status 'done'
  Created wheel for ninja: filename=ninja-1.11.1-cp310-cp310-linux_x86_64.whl size=129270 sha256=458078d7a32f086ba96a24a185ea7c5597544b30bf7eabd3e6d4a434f9db60c3
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/ef/1a/fb/858d1cae90791e6fb1a90407c5ec1a98cb71558d05ba56a676
  Building wheel for psutil (pyproject.toml): started
  Building wheel for psutil (pyproject.toml): finished with status 'done'
  Created wheel for psutil: filename=psutil-5.9.5-cp310-abi3-linux_x86_64.whl size=281632 sha256=e7ce068dbc27992e1017ead35477d0f1bd0b465c811650fcd863aa81deda5c90
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/1f/3a/db/ba9717f3efd7f8da8910eca12dc9cd15d404035397af627e7c
  Building wheel for py-cpuinfo (pyproject.toml): started
  Building wheel for py-cpuinfo (pyproject.toml): finished with status 'done'
  Created wheel for py-cpuinfo: filename=py_cpuinfo-9.0.0-py3-none-any.whl size=22315 sha256=c0f5b1842affde0c777492ec769de6069da158da5fdbff46d5d22c9683867ac3
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/ce/5e/c4/5d83c860ce6dc6431eaeb37284535e9e8da1220d1e72eec702
  Building wheel for tqdm (pyproject.toml): started
  Building wheel for tqdm (pyproject.toml): finished with status 'done'
  Created wheel for tqdm: filename=tqdm-4.66.1-py3-none-any.whl size=78257 sha256=af80c29a2f6a06650136ec7dadd32843becfdbbc6f3ae8c10626dc695129d012
  Stored in directory: /tmp/pip-ephem-wheel-cache-vdcivi_6/wheels/47/d6/7c/b5985ec12eeb5165f396eaaba0e5e8a378e91a69ce3147477d
Successfully built deepspeed packaging pydantic hjson ninja psutil py-cpuinfo tqdm
Installing collected packages: py-cpuinfo, ninja, hjson, tqdm, pydantic, psutil, packaging, deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.1+57a27b08
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed hjson-3.1.0 ninja-1.11.1 packaging-23.2 psutil-5.9.5 py-cpuinfo-9.0.0 pydantic-1.10.13 tqdm-4.66.1
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440347 sha256=dd9d1ea9a88855202ac963662a512d89622c5d46b986c3ee38b59faeb2e99cd5
  Stored in directory: /tmp/pip-ephem-wheel-cache-2mhpeckr/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440353 sha256=7fdabba77027f5eda0dd2465d72853e3a58f69949521726114792320fd25cff2
  Stored in directory: /tmp/pip-ephem-wheel-cache-v9pz_6me/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440083 sha256=2559fd496d8aceeb86a48da05f32f0bbc6ce518962817ddc50a407c6f28ea754
  Stored in directory: /tmp/pip-ephem-wheel-cache-44rdqg41/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440110 sha256=55193dc80d85af0e1bf325ea96747db1984bc2c0a91d426b773af60242b87fa6
  Stored in directory: /tmp/pip-ephem-wheel-cache-6g61bpi7/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440109 sha256=1deee7853d4afc2b43502b705ba657253ce0238842c07dc280b490b1b049904f
  Stored in directory: /tmp/pip-ephem-wheel-cache-m8mhpg9o/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=66440107 sha256=ea8ccb55f8784748a56aecb6a3d5a10a31bb5f32a22c02057b1ec36df6be6e1a
  Stored in directory: /tmp/pip-ephem-wheel-cache-kt_7_3ga/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'error'
  Running setup.py clean for deepspeed
Failed to build deepspeed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65714743 sha256=6fbb20464acabee363e7248fd1e54cd4e70458a7b39b47e55e06eafed9c3b66b
  Stored in directory: /tmp/pip-ephem-wheel-cache-2vgv27pj/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65714755 sha256=eed8e9f1681877cd633bd507d8916f73b6626e2e6beb1e985ce5d8ea3f01ceda
  Stored in directory: /tmp/pip-ephem-wheel-cache-mxdzpiof/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'error'
  Running setup.py clean for deepspeed
Failed to build deepspeed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65713778 sha256=afd138e5ca0c3a31dd5bf36e0f425d09dfb4a4b7ddf5760817e8b589f5fa912e
  Stored in directory: /tmp/pip-ephem-wheel-cache-u_2s7lf7/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65714369 sha256=e99b10d32c7633bcdd60bbabb142043424f07ed152904ae5cc8d48b6a2b62ab0
  Stored in directory: /tmp/pip-ephem-wheel-cache-rl6udewi/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65714361 sha256=4ab1f1ff7d5b8c73dea9d18b1b0c3c690718306500e95633dc884005ca2362bd
  Stored in directory: /tmp/pip-ephem-wheel-cache-mpfv4u_j/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65714359 sha256=61f409a6f096168c7066732e6ca5a8888fbfd6ea1e4666b6266fda7b8163210a
  Stored in directory: /tmp/pip-ephem-wheel-cache-ilx5eoj0/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Processing /home/amaurya/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (3.1.0)
Requirement already satisfied: ninja in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.11.1)
Requirement already satisfied: numpy in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.24.1)
Requirement already satisfied: packaging>=20.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (23.2)
Requirement already satisfied: psutil in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (1.10.13)
Requirement already satisfied: tqdm in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from deepspeed==0.10.4+e78a15ed) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/amaurya/.conda/envs/ds_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+e78a15ed) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+e78a15ed-cp310-cp310-linux_x86_64.whl size=65714613 sha256=bdeeac5c935261422e5ed1aca0df37a0be59fe6b7868b84b05d952b7fd48db65
  Stored in directory: /tmp/pip-ephem-wheel-cache-f8ygrw43/wheels/21/d4/57/e108abceab67e09ec2492320265351b83abd81027bce925dd9
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+e78a15ed
    Can't uninstall 'deepspeed'. No files were found to uninstall.
Successfully installed deepspeed-0.10.4+e78a15ed
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting hjson (from deepspeed==0.10.4+7bc01fdb)
  Using cached hjson-3.1.0-py3-none-any.whl
Collecting ninja (from deepspeed==0.10.4+7bc01fdb)
  Using cached ninja-1.11.1.tar.gz (27 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.24.1)
Collecting packaging>=20.0 (from deepspeed==0.10.4+7bc01fdb)
  Using cached packaging-23.2-py3-none-any.whl
Collecting psutil (from deepspeed==0.10.4+7bc01fdb)
  Using cached psutil-5.9.5.tar.gz (493 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Collecting tqdm (from deepspeed==0.10.4+7bc01fdb)
  Using cached tqdm-4.66.1.tar.gz (169 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.4.0)
Building wheels for collected packages: deepspeed, ninja, psutil, tqdm
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'error'
  error: subprocess-exited-with-error
  
  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> [872 lines of output]
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
      [93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x1509525a9b40>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x15083a4b2290>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x15083a4b2500>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x15083a4b2020>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x15083a4b2ec0>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x15083a4b2350>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x15083a3c8130>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x15083a3c81f0>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x15083a1d7340>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x15083a1d7250>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no g++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      building 'deepspeed.ops.random_ltd_op' extension
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      building 'deepspeed.ops.adam.fused_adam_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/aio
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/veloc
      creating build/temp.linux-x86_64-cpython-310/csrc/adagrad
      creating build/temp.linux-x86_64-cpython-310/csrc/random_ltd
      building 'deepspeed.ops.transformer.transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/lamb
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/common
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/aio/common/deepspeed_aio_common.cpp:15:10: fatal error: libaio.h: No such file or directory
         15 | #include <libaio.h>
            |          ^~~~~~~~~~
      compilation terminated.
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/utils/pybind.h:5,
                       from csrc/veloc/deepspeed_py_veloc.h:6,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/lib.linux-x86_64-cpython-310
      creating build/lib.linux-x86_64-cpython-310/deepspeed
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      g++ -pthread -B /home/am6429/.conda/envs/dspeed_env2/compiler_compat -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_32 against undefined symbol `__pthread_key_create' can not be used when making a shared object; recompile with -fPIC
      /home/am6429/.conda/envs/dspeed_env2/compiler_compat/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      error: command '/soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for deepspeed
  Running setup.py clean for deepspeed
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting hjson (from deepspeed==0.10.4+7bc01fdb)
  Using cached hjson-3.1.0-py3-none-any.whl
Collecting ninja (from deepspeed==0.10.4+7bc01fdb)
  Using cached ninja-1.11.1.tar.gz (27 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.24.1)
Collecting packaging>=20.0 (from deepspeed==0.10.4+7bc01fdb)
  Using cached packaging-23.2-py3-none-any.whl
Collecting psutil (from deepspeed==0.10.4+7bc01fdb)
  Using cached psutil-5.9.5.tar.gz (493 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Collecting tqdm (from deepspeed==0.10.4+7bc01fdb)
  Using cached tqdm-4.66.1.tar.gz (169 kB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Getting requirements to build wheel: started
  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.4.0)
Building wheels for collected packages: deepspeed, ninja, psutil, tqdm
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'error'
  error: subprocess-exited-with-error
  
  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> [862 lines of output]
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
      [93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x14dd557f9900>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x14dc229da320>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x14dc229dbd00>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x14dc229dbee0>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x14dc229d9db0>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x14dc229dbd30>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x14dc229dbdf0>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x14dc227d08b0>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x14dc22732980>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x14dc22731450>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      building 'deepspeed.ops.random_ltd_op' extension
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.adam.fused_adam_op' extension
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/aio
      creating build/temp.linux-x86_64-cpython-310/csrc/random_ltd
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/common
      creating build/temp.linux-x86_64-cpython-310/csrc/adagrad
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/veloc
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      building 'deepspeed.ops.transformer.transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/lamb
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/aio/common/deepspeed_aio_common.cpp:15:10: fatal error: libaio.h: No such file or directory
         15 | #include <libaio.h>
            |          ^~~~~~~~~~
      compilation terminated.
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/utils/pybind.h:5,
                       from csrc/veloc/deepspeed_py_veloc.h:6,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      creating build/lib.linux-x86_64-cpython-310
      creating build/lib.linux-x86_64-cpython-310/deepspeed
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      error: command '/soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for deepspeed
  Running setup.py clean for deepspeed
  error: subprocess-exited-with-error
  
  × python setup.py clean did not run successfully.
  │ exit code: 1
  ╰─> [1618 lines of output]
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
      [93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x1525c50c5900>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x1524921ed810>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x1524921eef50>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x1524921ef670>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x1524921edea0>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x1524921ef370>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x1524921eece0>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x1524921f88e0>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x152492032980>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x152492031450>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.adam.fused_adam_op' extension
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.transformer.transformer_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/assert.h:36,
                       from csrc/aio/common/deepspeed_aio_common.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/utils/pybind.h:5,
                       from csrc/veloc/deepspeed_py_veloc.h:6,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'void _do_io_submit_singles(long long int, long long int, std::unique_ptr<aio_context>&, std::vector<std::chrono::duration<double> >&)':
      csrc/aio/common/deepspeed_aio_common.cpp:78:20: warning: unused variable 'submit_ret' [-Wunused-variable]
         78 |         const auto submit_ret = io_submit(aio_ctxt->_io_ctxt, 1, aio_ctxt->_iocbs.data() + i);
            |                    ^~~~~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'void _do_io_submit_block(long long int, long long int, std::unique_ptr<aio_context>&, std::vector<std::chrono::duration<double> >&)':
      csrc/aio/common/deepspeed_aio_common.cpp:98:16: warning: unused variable 'submit_ret' [-Wunused-variable]
         98 |     const auto submit_ret = io_submit(aio_ctxt->_io_ctxt, n_iocbs, aio_ctxt->_iocbs.data());
            |                ^~~~~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'int regular_read(const char*, std::vector<char>&)':
      csrc/aio/common/deepspeed_aio_common.cpp:282:16: warning: unused variable 'f_size' [-Wunused-variable]
        282 |     const auto f_size = get_file_size(filename, num_bytes);
            |                ^~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'bool _validate_buffer(const char*, void*, long long int)':
      csrc/aio/common/deepspeed_aio_common.cpp:309:16: warning: unused variable 'reg_ret' [-Wunused-variable]
        309 |     const auto reg_ret = regular_read(filename, regular_buffer);
            |                ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_types.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_types.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/cmath:41,
                       from csrc/aio/common/deepspeed_aio_types.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_utils.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_utils.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/cmath:41,
                       from csrc/aio/common/deepspeed_aio_utils.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/py_lib/deepspeed_aio_thread.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_aio_thread.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/type_traits:38,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/ratio:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/chrono:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/condition_variable:38,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:10,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/typeid.h:17,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:18,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/irange.h: In member function 'bool c10::detail::integer_iterator<I, one_sided, <anonymous> >::operator==(const c10::detail::integer_iterator<I, one_sided, <anonymous> >&) const':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/irange.h:50:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         50 |     if constexpr (one_sided) {
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue.h:1499,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/List_inl.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/List.h:490,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/IListRef_inl.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/IListRef.h:632,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/WrapDimUtils.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/TensorNames.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/NamedTensorUtils.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:12: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |            ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:30: error: 'is_convertible_v' is not a member of 'std'; did you mean 'is_convertible'?
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                              ^~~~~~~~~~~~~~~~
            |                              is_convertible
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:91: error: expected '(' before ',' token
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:111: error: expected primary-expression before '>' token
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:112: error: expected primary-expression before ')' token
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1062:16: warning: structured bindings only available with '-std=c++17' or '-std=gnu++17'
       1062 |           auto [ivalue, storages] = cb(parentFut);
            |                ^
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction_impl.h:1,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction.h:251,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/op_registration/op_registration.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/library.h:68,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd_not_implemented_fallback.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h: In static member function 'static Result c10::impl::BoxedKernelWrapper<Result(Args ...), typename std::enable_if<((c10::guts::conjunction<c10::guts::disjunction<std::is_constructible<c10::IValue, typename std::decay<Args>::type>, std::is_same<c10::TensorOptions, typename std::decay<Args>::type> >...>::value && c10::guts::conjunction<c10::guts::disjunction<c10::impl::has_ivalue_to<T, void>, std::is_same<void, ReturnType> >, c10::guts::negation<std::is_lvalue_reference<_Tp> > >::value) && (! c10::impl::is_tuple_of_mutable_tensor_refs<Result>::value)), void>::type>::call(const c10::BoxedKernel&, const c10::OperatorHandle&, c10::DispatchKeySet, Args ...)':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:25: error: 'is_same_v' is not a member of 'std'; did you mean 'is_same'?
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                         ^~~~~~~~~
            |                         is_same
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:35: error: expected primary-expression before 'void'
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                                   ^~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:34: warning: logical not is only applied to the left hand side of comparison [-Wlogical-not-parentheses]
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:35: error: expected ')' before 'void'
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                                   ^~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:18: note: to match this '('
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                  ^
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction_impl.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction.h:251,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/op_registration/op_registration.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/library.h:68,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd_not_implemented_fallback.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h: In constructor 'c10::impl::assert_is_valid_input_type<T, AllowDeprecatedTypes, Enable>::assert_is_valid_input_type()':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h:109:10: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        109 |       if constexpr (guts::typelist::contains<supported_primitive_arg_types, T>::value) {
            |          ^~~~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction_impl.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction.h:251,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/op_registration/op_registration.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/library.h:68,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd_not_implemented_fallback.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h: In constructor 'c10::impl::assert_is_valid_output_type<T, AllowDeprecatedTypes, Enable>::assert_is_valid_output_type()':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h:215:10: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        215 |       if constexpr(guts::typelist::contains<supported_primitive_arg_types, T>::value) {
            |          ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h: In static member function 'static void c10::impl::make_boxed_from_unboxed_functor<KernelFunctor, AllowDeprecatedTypes>::call(c10::OperatorKernel*, const c10::OperatorHandle&, c10::DispatchKeySet, c10::Stack*)':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h:575:10: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        575 |       if constexpr (has_outputs) {
            |          ^~~~~~~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:391:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        391 |   AT_DISPATCH_CASE(at::ScalarType::Byte, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:392:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        392 |   AT_DISPATCH_CASE(at::ScalarType::Char, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:393:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        393 |   AT_DISPATCH_CASE(at::ScalarType::Int, __VA_ARGS__)  \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:394:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        394 |   AT_DISPATCH_CASE(at::ScalarType::Long, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:395:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        395 |   AT_DISPATCH_CASE(at::ScalarType::Short, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:233:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        233 |   AT_DISPATCH_CASE(at::ScalarType::Double, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:234:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        234 |   AT_DISPATCH_CASE(at::ScalarType::Float, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:515:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        515 |   AT_DISPATCH_CASE(SCALARTYPE1, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:516:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        516 |   AT_DISPATCH_CASE(SCALARTYPE2, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:517:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        517 |   AT_DISPATCH_CASE(SCALARTYPE3, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:391:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        391 |   AT_DISPATCH_CASE(at::ScalarType::Byte, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:392:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        392 |   AT_DISPATCH_CASE(at::ScalarType::Char, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:393:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        393 |   AT_DISPATCH_CASE(at::ScalarType::Int, __VA_ARGS__)  \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:394:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        394 |   AT_DISPATCH_CASE(at::ScalarType::Long, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:395:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        395 |   AT_DISPATCH_CASE(at::ScalarType::Short, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:233:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        233 |   AT_DISPATCH_CASE(at::ScalarType::Double, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:234:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        234 |   AT_DISPATCH_CASE(at::ScalarType::Float, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:515:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        515 |   AT_DISPATCH_CASE(SCALARTYPE1, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:516:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        516 |   AT_DISPATCH_CASE(SCALARTYPE2, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:517:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        517 |   AT_DISPATCH_CASE(SCALARTYPE3, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:12,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/dispatch/Dispatcher.h: In static member function 'static Return c10::Dispatcher::callWithDispatchKeySlowPath(const c10::TypedOperatorHandle<Return(Args ...)>&, at::StepCallbacks&, c10::DispatchKeySet, const c10::KernelFunction&, Args ...)':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/dispatch/Dispatcher.h:597:6: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        597 |   if constexpr (num_boxed_args != 0) {
            |      ^~~~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:233:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        233 |   AT_DISPATCH_CASE(at::ScalarType::Double, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:237:34: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        237 |   AT_DISPATCH_SWITCH(TYPE, NAME, AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__))
            |                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:895:27: note: in expansion of macro 'AT_DISPATCH_FLOATING_TYPES'
        895 |     attn_output_weights = AT_DISPATCH_FLOATING_TYPES(
            |                           ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:234:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        234 |   AT_DISPATCH_CASE(at::ScalarType::Float, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:237:34: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        237 |   AT_DISPATCH_SWITCH(TYPE, NAME, AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__))
            |                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:895:27: note: in expansion of macro 'AT_DISPATCH_FLOATING_TYPES'
        895 |     attn_output_weights = AT_DISPATCH_FLOATING_TYPES(
            |                           ^~~~~~~~~~~~~~~~~~~~~~~~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      error: command '/home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed cleaning build dir for deepspeed
  WARNING: Ignoring --global-option when building ninja using PEP 517
  Building wheel for ninja (pyproject.toml): started
  Building wheel for ninja (pyproject.toml): finished with status 'done'
  Created wheel for ninja: filename=ninja-1.11.1-cp310-cp310-linux_x86_64.whl size=154019 sha256=fb7f85b1f233995aedffdd5fce80af52e803cac4365740c3aa6aa496419acdcd
  Stored in directory: /home/am6429/.cache/pip/wheels/ef/1a/fb/858d1cae90791e6fb1a90407c5ec1a98cb71558d05ba56a676
  WARNING: Ignoring --global-option when building psutil using PEP 517
  Building wheel for psutil (pyproject.toml): started
  Building wheel for psutil (pyproject.toml): finished with status 'done'
  Created wheel for psutil: filename=psutil-5.9.5-cp310-abi3-linux_x86_64.whl size=236532 sha256=b1e0a61f698d2c127271e420f7a9a68b04f57a425ef238d668160ee8e947c836
  Stored in directory: /home/am6429/.cache/pip/wheels/1f/3a/db/ba9717f3efd7f8da8910eca12dc9cd15d404035397af627e7c
  WARNING: Ignoring --global-option when building tqdm using PEP 517
  Building wheel for tqdm (pyproject.toml): started
  Building wheel for tqdm (pyproject.toml): finished with status 'done'
  Created wheel for tqdm: filename=tqdm-4.66.1-py3-none-any.whl size=78257 sha256=b1070cde7e3f37ca32c2cec862b0106cd8190c47d4ff37034d774e2169456524
  Stored in directory: /home/am6429/.cache/pip/wheels/47/d6/7c/b5985ec12eeb5165f396eaaba0e5e8a378e91a69ce3147477d
Successfully built ninja psutil tqdm
Failed to build deepspeed
ERROR: Could not build wheels for deepspeed, which is required to install pyproject.toml-based projects
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Collecting hjson (from deepspeed==0.10.4+7bc01fdb)
  Using cached hjson-3.1.0-py3-none-any.whl
Collecting ninja (from deepspeed==0.10.4+7bc01fdb)
  Using cached ninja-1.11.1-cp310-cp310-linux_x86_64.whl
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.24.1)
Collecting packaging>=20.0 (from deepspeed==0.10.4+7bc01fdb)
  Using cached packaging-23.2-py3-none-any.whl
Collecting psutil (from deepspeed==0.10.4+7bc01fdb)
  Using cached psutil-5.9.5-cp310-abi3-linux_x86_64.whl
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Collecting tqdm (from deepspeed==0.10.4+7bc01fdb)
  Using cached tqdm-4.66.1-py3-none-any.whl
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.4.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'error'
  error: subprocess-exited-with-error
  
  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> [902 lines of output]
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
      [93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x14bfcb341a80>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x14beaada61d0>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x14beaada5f60>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x14beaada6470>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x14beaada7f70>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x14beaada7fa0>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x14beaada64d0>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x14beaabf0160>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x14beaaac3100>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x14beaaac3820>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      building 'deepspeed.ops.random_ltd_op' extension
      creating build/temp.linux-x86_64-cpython-310
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.transformer.transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc/aio
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/adagrad
      creating build/temp.linux-x86_64-cpython-310/csrc/random_ltd
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/common
      building 'deepspeed.ops.adam.fused_adam_op' extension
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/veloc
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/lamb
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/aio/common/deepspeed_aio_common.cpp:15:10: fatal error: libaio.h: No such file or directory
         15 | #include <libaio.h>
            |          ^~~~~~~~~~
      compilation terminated.
      In file included from csrc/includes/cpu_adagrad.h:13,
                       from csrc/adagrad/cpu_adagrad.cpp:6:
      csrc/includes/simd.h:69: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
         69 | #pragma unroll
            |
      csrc/includes/simd.h:76: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
         76 | #pragma unroll
            |
      csrc/includes/simd.h:82: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
         82 | #pragma unroll
            |
      csrc/includes/simd.h:90: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
         90 | #pragma unroll
            |
      csrc/includes/simd.h:98: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
         98 | #pragma unroll
            |
      csrc/includes/simd.h:106: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
        106 | #pragma unroll
            |
      csrc/includes/simd.h:112: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
        112 | #pragma unroll
            |
      csrc/includes/simd.h:118: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
        118 | #pragma unroll
            |
      csrc/includes/simd.h:124: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
        124 | #pragma unroll
            |
      csrc/includes/simd.h:130: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
        130 | #pragma unroll
            |
      csrc/includes/simd.h:136: warning: ignoring '#pragma unroll ' [-Wunknown-pragmas]
        136 | #pragma unroll
            |
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/utils/pybind.h:5,
                       from csrc/veloc/deepspeed_py_veloc.h:6,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/adagrad/cpu_adagrad.cpp: In member function 'void Adagrad_Optimizer::Step_1(float*, float*, float*, size_t, ds_half_precision_t*, bool)':
      csrc/adagrad/cpu_adagrad.cpp:51:9: warning: 'params_cast_h' may be used uninitialized in this function [-Wmaybe-uninitialized]
         51 | #pragma omp parallel for
            |         ^~~
      csrc/adagrad/cpu_adagrad.cpp:38:30: warning: 'grads_cast_h' may be used uninitialized in this function [-Wmaybe-uninitialized]
         38 |         ds_half_precision_t* grads_cast_h;
            |                              ^~~~~~~~~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      creating build/lib.linux-x86_64-cpython-310
      creating build/lib.linux-x86_64-cpython-310/deepspeed
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      error: command '/soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for deepspeed
  Running setup.py clean for deepspeed
  error: subprocess-exited-with-error
  
  × python setup.py clean did not run successfully.
  │ exit code: 1
  ╰─> [1611 lines of output]
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
      [93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x14d4fce11a80>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x14d3dc68a1a0>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x14d3dc689f30>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x14d3dc68a440>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x14d3dc68bf40>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x14d3dc68bf70>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x14d3dc68add0>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x14d3dc69cbb0>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x14d3dc59b070>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x14d3dc59b820>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.adam.fused_adam_op' extension
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.transformer.transformer_op' extension
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/assert.h:36,
                       from csrc/aio/common/deepspeed_aio_common.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/utils/pybind.h:5,
                       from csrc/veloc/deepspeed_py_veloc.h:6,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'void _do_io_submit_singles(long long int, long long int, std::unique_ptr<aio_context>&, std::vector<std::chrono::duration<double> >&)':
      csrc/aio/common/deepspeed_aio_common.cpp:78:20: warning: unused variable 'submit_ret' [-Wunused-variable]
         78 |         const auto submit_ret = io_submit(aio_ctxt->_io_ctxt, 1, aio_ctxt->_iocbs.data() + i);
            |                    ^~~~~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'void _do_io_submit_block(long long int, long long int, std::unique_ptr<aio_context>&, std::vector<std::chrono::duration<double> >&)':
      csrc/aio/common/deepspeed_aio_common.cpp:98:16: warning: unused variable 'submit_ret' [-Wunused-variable]
         98 |     const auto submit_ret = io_submit(aio_ctxt->_io_ctxt, n_iocbs, aio_ctxt->_iocbs.data());
            |                ^~~~~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'int regular_read(const char*, std::vector<char>&)':
      csrc/aio/common/deepspeed_aio_common.cpp:282:16: warning: unused variable 'f_size' [-Wunused-variable]
        282 |     const auto f_size = get_file_size(filename, num_bytes);
            |                ^~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'bool _validate_buffer(const char*, void*, long long int)':
      csrc/aio/common/deepspeed_aio_common.cpp:309:16: warning: unused variable 'reg_ret' [-Wunused-variable]
        309 |     const auto reg_ret = regular_read(filename, regular_buffer);
            |                ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_types.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_types.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/cmath:41,
                       from csrc/aio/common/deepspeed_aio_types.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/common/deepspeed_aio_utils.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_utils.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/cmath:41,
                       from csrc/aio/common/deepspeed_aio_utils.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/torch.h:3,
                       from csrc/veloc/deepspeed_py_veloc.h:18,
                       from csrc/veloc/deepspeed_py_veloc.cu:1:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/aio/py_lib/deepspeed_aio_thread.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_aio_thread.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/type_traits:38,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/ratio:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/chrono:39,
                       from /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/include/c++/11.4.0/condition_variable:38,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:10,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:4:2: error: #error C++17 or later compatible compiler is required to use PyTorch.
          4 | #error C++17 or later compatible compiler is required to use PyTorch.
            |  ^~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/string_view.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/StringUtil.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/Exception.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/Device.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/C++17.h:27:2: error: #error You need C++17 to compile PyTorch
         27 | #error You need C++17 to compile PyTorch
            |  ^~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:4:2: error: #error C++17 or later compatible compiler is required to use ATen.
          4 | #error C++17 or later compatible compiler is required to use ATen.
            |  ^~~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/typeid.h:17,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:5,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:18,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/irange.h: In member function 'bool c10::detail::integer_iterator<I, one_sided, <anonymous> >::operator==(const c10::detail::integer_iterator<I, one_sided, <anonymous> >&) const':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/c10/util/irange.h:50:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         50 |     if constexpr (one_sided) {
            |        ^~~~~~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue.h:1499,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/List_inl.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/List.h:490,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/IListRef_inl.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/IListRef.h:632,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/WrapDimUtils.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/TensorNames.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/NamedTensorUtils.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:12: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |            ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:30: error: 'is_convertible_v' is not a member of 'std'; did you mean 'is_convertible'?
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                              ^~~~~~~~~~~~~~~~
            |                              is_convertible
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:91: error: expected '(' before ',' token
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:111: error: expected primary-expression before '>' token
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1061:112: error: expected primary-expression before ')' token
       1061 |         if constexpr (::std::is_convertible_v<typename c10::invoke_result_t<T &&, Future&>, IValueWithStorages>) {
            |                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/ivalue_inl.h:1062:16: warning: structured bindings only available with '-std=c++17' or '-std=gnu++17'
       1062 |           auto [ivalue, storages] = cb(parentFut);
            |                ^
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction_impl.h:1,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction.h:251,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/op_registration/op_registration.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/library.h:68,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd_not_implemented_fallback.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h: In static member function 'static Result c10::impl::BoxedKernelWrapper<Result(Args ...), typename std::enable_if<((c10::guts::conjunction<c10::guts::disjunction<std::is_constructible<c10::IValue, typename std::decay<Args>::type>, std::is_same<c10::TensorOptions, typename std::decay<Args>::type> >...>::value && c10::guts::conjunction<c10::guts::disjunction<c10::impl::has_ivalue_to<T, void>, std::is_same<void, ReturnType> >, c10::guts::negation<std::is_lvalue_reference<_Tp> > >::value) && (! c10::impl::is_tuple_of_mutable_tensor_refs<Result>::value)), void>::type>::call(const c10::BoxedKernel&, const c10::OperatorHandle&, c10::DispatchKeySet, Args ...)':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:25: error: 'is_same_v' is not a member of 'std'; did you mean 'is_same'?
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                         ^~~~~~~~~
            |                         is_same
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:35: error: expected primary-expression before 'void'
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                                   ^~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:34: warning: logical not is only applied to the left hand side of comparison [-Wlogical-not-parentheses]
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:35: error: expected ')' before 'void'
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                                   ^~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/boxing.h:229:18: note: to match this '('
        229 |     if constexpr (!std::is_same_v<void, Result>) {
            |                  ^
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction_impl.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction.h:251,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/op_registration/op_registration.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/library.h:68,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd_not_implemented_fallback.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h: In constructor 'c10::impl::assert_is_valid_input_type<T, AllowDeprecatedTypes, Enable>::assert_is_valid_input_type()':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h:109:10: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        109 |       if constexpr (guts::typelist::contains<supported_primitive_arg_types, T>::value) {
            |          ^~~~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction_impl.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/KernelFunction.h:251,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/op_registration/op_registration.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/library.h:68,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd_not_implemented_fallback.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h: In constructor 'c10::impl::assert_is_valid_output_type<T, AllowDeprecatedTypes, Enable>::assert_is_valid_output_type()':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h:215:10: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        215 |       if constexpr(guts::typelist::contains<supported_primitive_arg_types, T>::value) {
            |          ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h: In static member function 'static void c10::impl::make_boxed_from_unboxed_functor<KernelFunctor, AllowDeprecatedTypes>::call(c10::OperatorKernel*, const c10::OperatorHandle&, c10::DispatchKeySet, c10::Stack*)':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h:575:10: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        575 |       if constexpr (has_outputs) {
            |          ^~~~~~~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:391:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        391 |   AT_DISPATCH_CASE(at::ScalarType::Byte, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:392:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        392 |   AT_DISPATCH_CASE(at::ScalarType::Char, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:393:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        393 |   AT_DISPATCH_CASE(at::ScalarType::Int, __VA_ARGS__)  \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:394:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        394 |   AT_DISPATCH_CASE(at::ScalarType::Long, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:395:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        395 |   AT_DISPATCH_CASE(at::ScalarType::Short, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:233:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        233 |   AT_DISPATCH_CASE(at::ScalarType::Double, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:234:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        234 |   AT_DISPATCH_CASE(at::ScalarType::Float, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:515:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        515 |   AT_DISPATCH_CASE(SCALARTYPE1, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:516:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        516 |   AT_DISPATCH_CASE(SCALARTYPE2, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:517:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        517 |   AT_DISPATCH_CASE(SCALARTYPE3, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:287:7: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        287 |       AT_DISPATCH_ALL_TYPES_AND3(
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:391:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        391 |   AT_DISPATCH_CASE(at::ScalarType::Byte, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:392:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        392 |   AT_DISPATCH_CASE(at::ScalarType::Char, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:393:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        393 |   AT_DISPATCH_CASE(at::ScalarType::Int, __VA_ARGS__)  \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:394:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        394 |   AT_DISPATCH_CASE(at::ScalarType::Long, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:395:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        395 |   AT_DISPATCH_CASE(at::ScalarType::Short, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:411:3: note: in expansion of macro 'AT_DISPATCH_CASE_INTEGRAL_TYPES'
        411 |   AT_DISPATCH_CASE_INTEGRAL_TYPES(__VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:233:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        233 |   AT_DISPATCH_CASE(at::ScalarType::Double, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:234:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        234 |   AT_DISPATCH_CASE(at::ScalarType::Float, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:412:3: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        412 |   AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:514:3: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES'
        514 |   AT_DISPATCH_CASE_ALL_TYPES(__VA_ARGS__)       \
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:515:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        515 |   AT_DISPATCH_CASE(SCALARTYPE1, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:516:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        516 |   AT_DISPATCH_CASE(SCALARTYPE2, __VA_ARGS__)    \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:517:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        517 |   AT_DISPATCH_CASE(SCALARTYPE3, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:524:7: note: in expansion of macro 'AT_DISPATCH_CASE_ALL_TYPES_AND3'
        524 |       AT_DISPATCH_CASE_ALL_TYPES_AND3(                      \
            |       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:307:9: note: in expansion of macro 'AT_DISPATCH_ALL_TYPES_AND3'
        307 |         AT_DISPATCH_ALL_TYPES_AND3(
            |         ^~~~~~~~~~~~~~~~~~~~~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:12,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/dispatch/Dispatcher.h: In static member function 'static Return c10::Dispatcher::callWithDispatchKeySlowPath(const c10::TypedOperatorHandle<Return(Args ...)>&, at::StepCallbacks&, c10::DispatchKeySet, const c10::KernelFunction&, Args ...)':
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/dispatch/Dispatcher.h:597:6: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
        597 |   if constexpr (num_boxed_args != 0) {
            |      ^~~~~~~~~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/ATen.h:11,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:4,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:9,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/aio/py_lib/deepspeed_py_aio.h:15,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:13,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h: In lambda function:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:233:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        233 |   AT_DISPATCH_CASE(at::ScalarType::Double, __VA_ARGS__) \
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:237:34: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        237 |   AT_DISPATCH_SWITCH(TYPE, NAME, AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__))
            |                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:895:27: note: in expansion of macro 'AT_DISPATCH_FLOATING_TYPES'
        895 |     attn_output_weights = AT_DISPATCH_FLOATING_TYPES(
            |                           ^~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:56:8: warning: 'if constexpr' only available with '-std=c++17' or '-std=gnu++17'
         56 |     if constexpr (!at::should_include_kernel_dtype(   \
            |        ^~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:221:7: note: in definition of macro 'AT_DISPATCH_SWITCH'
        221 |       __VA_ARGS__                                                           \
            |       ^~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:68:5: note: in expansion of macro 'AT_PRIVATE_CHECK_SELECTIVE_BUILD'
         68 |     AT_PRIVATE_CHECK_SELECTIVE_BUILD(enum_type);                        \
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:74:3: note: in expansion of macro 'AT_PRIVATE_CASE_TYPE_USING_HINT'
         74 |   AT_PRIVATE_CASE_TYPE_USING_HINT(enum_type, scalar_t, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:234:3: note: in expansion of macro 'AT_DISPATCH_CASE'
        234 |   AT_DISPATCH_CASE(at::ScalarType::Float, __VA_ARGS__)
            |   ^~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Dispatch.h:237:34: note: in expansion of macro 'AT_DISPATCH_CASE_FLOATING_TYPES'
        237 |   AT_DISPATCH_SWITCH(TYPE, NAME, AT_DISPATCH_CASE_FLOATING_TYPES(__VA_ARGS__))
            |                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:895:27: note: in expansion of macro 'AT_DISPATCH_FLOATING_TYPES'
        895 |     attn_output_weights = AT_DISPATCH_FLOATING_TYPES(
            |                           ^~~~~~~~~~~~~~~~~~~~~~~~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include -fPIC -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:1: note: declared here
        225 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:247:1: note: declared here
        247 |   T * data() const {
            | ^ ~~
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env2/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env2/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env2/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env2/lib -L/home/am6429/.conda/envs/dspeed_env2/lib -L/soft/datascience/conda/2023-10-02/mconda3/lib -Wl,--enable-new-dtags,-rpath,/soft/datascience/conda/2023-10-02/mconda3/lib -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env2/include -I/soft/datascience/conda/2023-10-02/mconda3/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env2/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env2/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      error: command '/home/am6429/.conda/envs/dspeed_env2/bin/x86_64-conda-linux-gnu-cc' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed cleaning build dir for deepspeed
Failed to build deepspeed
ERROR: Could not build wheels for deepspeed, which is required to install pyproject.toml-based projects
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (3.1.0)
Requirement already satisfied: ninja in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.11.1)
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.26.0)
Requirement already satisfied: packaging>=20.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (23.1)
Requirement already satisfied: psutil in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Requirement already satisfied: tqdm in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.8.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'error'
  error: subprocess-exited-with-error
  
  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> [2364 lines of output]
      [2023-10-04 19:43:21,420] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      [2023-10-04 19:43:22,872] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.0
      [93m [WARNING] [0m using untested triton version (2.0.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x147f77ca5900>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x147e4486d960>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x147e4486da20>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x147e4486d900>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x147e4486d630>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x147e4486dc60>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x147e4486da50>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x147e4486dcc0>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x147e4486db40>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x147e4486dc00>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/utils/cpp_extension.py:398: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      building 'deepspeed.ops.adam.fused_adam_op' extension
      building 'deepspeed.ops.transformer.transformer_op' extension
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      building 'deepspeed.ops.random_ltd_op' extension
      creating build/temp.linux-x86_64-cpython-310
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      creating build/temp.linux-x86_64-cpython-310/csrc/random_ltd
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/lamb
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/aio
      creating build/temp.linux-x86_64-cpython-310/csrc/veloc
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/temp.linux-x86_64-cpython-310/csrc/adagrad
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/common
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      csrc/aio/common/deepspeed_aio_common.cpp:15:10: fatal error: libaio.h: No such file or directory
         15 | #include <libaio.h>
            |          ^~~~~~~~~~
      compilation terminated.
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      creating build/lib.linux-x86_64-cpython-310
      creating build/lib.linux-x86_64-cpython-310/deepspeed
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::_pending_d2h' [-Wattributes]
         35 | class veloc_ckpt_t {
            |       ^~~~~~~~~~~~
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::argparse_module' [-Wattributes]
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::torch_module' [-Wattributes]
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/veloc/py_ds_veloc.cpp -o build/temp.linux-x86_64-cpython-310/csrc/veloc/py_ds_veloc.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -std=c++14 -fopenmp -shared -fPIC -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0
      nvcc warning : incompatible redefinition for option 'std', the last value of this option was used
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      In file included from csrc/veloc/py_ds_veloc.cpp:3:
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::_pending_d2h' [-Wattributes]
         35 | class veloc_ckpt_t {
            |       ^~~~~~~~~~~~
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::argparse_module' [-Wattributes]
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::torch_module' [-Wattributes]
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      collect2: error: ld returned 1 exit status
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/veloc
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o build/temp.linux-x86_64-cpython-310/csrc/veloc/py_ds_veloc.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/veloc/veloc_ckpt_op.cpython-310-x86_64-linux-gnu.so -lpthread
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      collect2: error: ld returned 1 exit status
      error: command '/soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for deepspeed
  Running setup.py clean for deepspeed
  error: subprocess-exited-with-error
  
  × python setup.py clean did not run successfully.
  │ exit code: 1
  ╰─> [1648 lines of output]
      [2023-10-04 19:46:16,490] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      [2023-10-04 19:46:17,993] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.0
      [93m [WARNING] [0m using untested triton version (2.0.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': 1, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.aio.async_io_op') at 0x15356f3c9900>, <setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x153437d8d960>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x153437d8da20>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x153437d8d900>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x153437d8d630>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x153437d8dc60>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x153437d8da50>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x153437d8dcc0>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x153437d8db40>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x153437d8dc00>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/utils/cpp_extension.py:398: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.aio.async_io_op' extension
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/common/deepspeed_aio_common.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.random_ltd_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.transformer.transformer_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/assert.h:36,
                       from csrc/aio/common/deepspeed_aio_common.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'void _do_io_submit_singles(long long int, long long int, std::unique_ptr<aio_context>&, std::vector<std::chrono::duration<double> >&)':
      csrc/aio/common/deepspeed_aio_common.cpp:78:20: warning: unused variable 'submit_ret' [-Wunused-variable]
         78 |         const auto submit_ret = io_submit(aio_ctxt->_io_ctxt, 1, aio_ctxt->_iocbs.data() + i);
            |                    ^~~~~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'void _do_io_submit_block(long long int, long long int, std::unique_ptr<aio_context>&, std::vector<std::chrono::duration<double> >&)':
      csrc/aio/common/deepspeed_aio_common.cpp:98:16: warning: unused variable 'submit_ret' [-Wunused-variable]
         98 |     const auto submit_ret = io_submit(aio_ctxt->_io_ctxt, n_iocbs, aio_ctxt->_iocbs.data());
            |                ^~~~~~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'int regular_read(const char*, std::vector<char>&)':
      csrc/aio/common/deepspeed_aio_common.cpp:282:16: warning: unused variable 'f_size' [-Wunused-variable]
        282 |     const auto f_size = get_file_size(filename, num_bytes);
            |                ^~~~~~
      csrc/aio/common/deepspeed_aio_common.cpp: In function 'bool _validate_buffer(const char*, void*, long long int)':
      csrc/aio/common/deepspeed_aio_common.cpp:309:16: warning: unused variable 'reg_ret' [-Wunused-variable]
        309 |     const auto reg_ret = regular_read(filename, regular_buffer);
            |                ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/common/deepspeed_aio_types.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_types.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/cmath:41,
                       from csrc/aio/common/deepspeed_aio_types.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/common/deepspeed_aio_utils.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_utils.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/cmath:41,
                       from csrc/aio/common/deepspeed_aio_utils.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/py_lib/deepspeed_aio_thread.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_aio_thread.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/type_traits:38,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/ratio:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/chrono:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/condition_variable:38,
                       from csrc/aio/py_lib/deepspeed_aio_thread.h:10,
                       from csrc/aio/py_lib/deepspeed_aio_thread.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/py_lib/deepspeed_pin_tensor.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_pin_tensor.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/bits/stl_algobase.h:59,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/bits/stl_tree.h:63,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/map:60,
                       from csrc/aio/py_lib/deepspeed_pin_tensor.h:14,
                       from csrc/aio/py_lib/deepspeed_pin_tensor.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/py_lib/deepspeed_py_aio.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_py_aio.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/assert.h:36,
                       from csrc/aio/py_lib/deepspeed_py_aio.cpp:13:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/py_lib/deepspeed_py_aio_handle.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_py_aio_handle.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/type_traits:38,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/ratio:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/chrono:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/condition_variable:38,
                       from csrc/aio/py_lib/deepspeed_py_aio_handle.h:10,
                       from csrc/aio/py_lib/deepspeed_py_aio_handle.cpp:13:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/py_lib/deepspeed_py_copy.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_py_copy.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/cstdlib:41,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/stdlib.h:36,
                       from /home/am6429/.conda/envs/dspeed_env/lib/gcc/x86_64-conda-linux-gnu/11.4.0/include/mm_malloc.h:27,
                       from /home/am6429/.conda/envs/dspeed_env/lib/gcc/x86_64-conda-linux-gnu/11.4.0/include/xmmintrin.h:34,
                       from /home/am6429/.conda/envs/dspeed_env/lib/gcc/x86_64-conda-linux-gnu/11.4.0/include/immintrin.h:31,
                       from /home/am6429/.conda/envs/dspeed_env/lib/gcc/x86_64-conda-linux-gnu/11.4.0/include/x86intrin.h:32,
                       from csrc/aio/py_lib/deepspeed_py_copy.h:15,
                       from csrc/aio/py_lib/deepspeed_py_copy.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/aio/py_lib -Icsrc/aio/common -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/aio/py_lib/py_ds_aio.cpp -o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/py_ds_aio.o -g -Wall -O0 -std=c++14 -shared -fPIC -Wno-reorder -march=native -fopenmp -D__AVX256__ -laio -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=async_io_op -D_GLIBCXX_USE_CXX11_ABI=0
      In file included from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/os_defines.h:39,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/x86_64-conda-linux-gnu/bits/c++config.h:586,
                       from /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/include/c++/11.4.0/cassert:43,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/macros/Macros.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/DeviceType.h:8,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/Device.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:11,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/aio/py_lib/py_ds_aio.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/x86_64-conda-linux-gnu/sysroot/usr/include/features.h:330:4: warning: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Wcpp]
        330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
            |    ^~~~~~~
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/Exceptions.h:14,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/python.h:11,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:6,
                       from csrc/aio/py_lib/py_ds_aio.cpp:10:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/pybind11/pybind11.h: In instantiation of 'class pybind11::class_<deepspeed_aio_handle_t>':
      csrc/aio/py_lib/py_ds_aio.cpp:22:55:   required from here
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/pybind11/pybind11.h:1479:7: warning: 'pybind11::class_<deepspeed_aio_handle_t>' declared with greater visibility than its base 'pybind11::detail::generic_type' [-Wattributes]
       1479 | class class_ : public detail::generic_type {
            |       ^~~~~~
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/aio
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_common.o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_types.o build/temp.linux-x86_64-cpython-310/csrc/aio/common/deepspeed_aio_utils.o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_aio_thread.o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_pin_tensor.o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_py_aio.o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_py_aio_handle.o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/deepspeed_py_copy.o build/temp.linux-x86_64-cpython-310/csrc/aio/py_lib/py_ds_aio.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -lc10 -ltorch -ltorch_cpu -ltorch_python -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/aio/async_io_op.cpython-310-x86_64-linux-gnu.so -laio
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      error: command '/home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed cleaning build dir for deepspeed
Failed to build deepspeed
ERROR: Could not build wheels for deepspeed, which is required to install pyproject.toml-based projects
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (3.1.0)
Requirement already satisfied: ninja in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.11.1)
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.26.0)
Requirement already satisfied: packaging>=20.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (23.1)
Requirement already satisfied: psutil in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Requirement already satisfied: tqdm in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.8.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'error'
  error: subprocess-exited-with-error
  
  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> [2354 lines of output]
      [2023-10-04 19:50:52,931] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      [2023-10-04 19:50:54,394] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.0
      [93m [WARNING] [0m using untested triton version (2.0.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': False, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x1495e059d930>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x1494ad01dc00>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x1494ad01dba0>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x1494ad01d870>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x1494ad01db10>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x1494ad01d9f0>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x1494ad01dc90>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x1494ad01dae0>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x1494ad01dbd0>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/utils/cpp_extension.py:398: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.adam.fused_adam_op' extension
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      creating build/temp.linux-x86_64-cpython-310
      creating build/temp.linux-x86_64-cpython-310
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.random_ltd_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.veloc.veloc_ckpt_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      creating build/temp.linux-x86_64-cpython-310/csrc/veloc
      creating build/temp.linux-x86_64-cpython-310/csrc/adagrad
      creating build/temp.linux-x86_64-cpython-310/csrc/random_ltd
      creating build/temp.linux-x86_64-cpython-310/csrc/adam
      creating build/temp.linux-x86_64-cpython-310/csrc/transformer
      creating build/temp.linux-x86_64-cpython-310/csrc/lamb
      building 'deepspeed.ops.transformer.transformer_op' extension
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/fused_adam_frontend.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/veloc/deepspeed_py_veloc.cu -o build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -std=c++14 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/temp.linux-x86_64-cpython-310/csrc/common
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -Icsrc/adam -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/multi_tensor_adam.cu -o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      creating build/lib.linux-x86_64-cpython-310
      creating build/lib.linux-x86_64-cpython-310/deepspeed
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::_pending_d2h' [-Wattributes]
         35 | class veloc_ckpt_t {
            |       ^~~~~~~~~~~~
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::argparse_module' [-Wattributes]
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::torch_module' [-Wattributes]
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/veloc -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/veloc/py_ds_veloc.cpp -o build/temp.linux-x86_64-cpython-310/csrc/veloc/py_ds_veloc.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -std=c++14 -fopenmp -shared -fPIC -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=veloc_ckpt_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      In file included from csrc/veloc/py_ds_veloc.cpp:3:
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::_pending_d2h' [-Wattributes]
         35 | class veloc_ckpt_t {
            |       ^~~~~~~~~~~~
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::argparse_module' [-Wattributes]
      csrc/veloc/deepspeed_py_veloc.h:35:7: warning: 'veloc_ckpt_t' declared with greater visibility than the type of its field 'veloc_ckpt_t::torch_module' [-Wattributes]
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adam/fused_adam_frontend.o build/temp.linux-x86_64-cpython-310/csrc/adam/multi_tensor_adam.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/fused_adam_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/veloc
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/veloc/deepspeed_py_veloc.o build/temp.linux-x86_64-cpython-310/csrc/veloc/py_ds_veloc.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/veloc/veloc_ckpt_op.cpython-310-x86_64-linux-gnu.so -lpthread
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      creating build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: error adding symbols: no error
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: error adding symbols: no error
      collect2: error: ld returned 1 exit status
      error: command '/home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for deepspeed
  Running setup.py clean for deepspeed
  error: subprocess-exited-with-error
  
  × python setup.py clean did not run successfully.
  │ exit code: 1
  ╰─> [2225 lines of output]
      [2023-10-04 19:53:45,561] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      [2023-10-04 19:53:47,000] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
      DS_BUILD_OPS=1
      [93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
      [93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.0
      [93m [WARNING] [0m using untested triton version (2.0.0), only 1.0.0 is known to be compatible
      Install Ops={'async_io': False, 'fused_adam': 1, 'cpu_adam': 1, 'cpu_adagrad': 1, 'evoformer_attn': False, 'fused_lamb': 1, 'quantizer': False, 'random_ltd': 1, 'sparse_attn': False, 'spatial_inference': 1, 'transformer': 1, 'stochastic_transformer': 1, 'transformer_inference': False, 'veloc_ckpt': 1}
      version=0.10.4+7bc01fdb, git_hash=7bc01fdb, git_branch=HEAD
      install_requires=['hjson', 'ninja', 'numpy', 'packaging>=20.0', 'psutil', 'py-cpuinfo', 'pydantic<2.0.0', 'tqdm']
      compatible_ops={'async_io': True, 'fused_adam': True, 'cpu_adam': True, 'cpu_adagrad': True, 'evoformer_attn': False, 'fused_lamb': True, 'quantizer': True, 'random_ltd': True, 'sparse_attn': False, 'spatial_inference': True, 'transformer': True, 'stochastic_transformer': True, 'transformer_inference': True, 'veloc_ckpt': True, 'deepspeed_not_implemented': False}
      ext_modules=[<setuptools.extension.Extension('deepspeed.ops.adam.fused_adam_op') at 0x14d86521d930>, <setuptools.extension.Extension('deepspeed.ops.adam.cpu_adam_op') at 0x14d731c59ba0>, <setuptools.extension.Extension('deepspeed.ops.adagrad.cpu_adagrad_op') at 0x14d731c59b40>, <setuptools.extension.Extension('deepspeed.ops.lamb.fused_lamb_op') at 0x14d731c59810>, <setuptools.extension.Extension('deepspeed.ops.random_ltd_op') at 0x14d731c59ab0>, <setuptools.extension.Extension('deepspeed.ops.spatial.spatial_inference_op') at 0x14d731c59990>, <setuptools.extension.Extension('deepspeed.ops.transformer.transformer_op') at 0x14d731c59c30>, <setuptools.extension.Extension('deepspeed.ops.transformer.stochastic_transformer_op') at 0x14d731c59a80>, <setuptools.extension.Extension('deepspeed.ops.veloc.veloc_ckpt_op') at 0x14d731c59b70>]
      running build_ext
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/utils/cpp_extension.py:398: UserWarning: There are no /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ version bounds defined for CUDA version 11.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'deepspeed.ops.spatial.spatial_inference_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/spatial/csrc/opt_bias_add.cu -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.transformer.stochastic_transformer_op' extension
      building 'deepspeed.ops.random_ltd_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/gather_scatter.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.transformer.transformer_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      building 'deepspeed.ops.lamb.fused_lamb_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/cublas_wrappers.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/lamb/fused_lamb_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o -O3 -std=c++17 -g -Wno-reorder -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.adam.cpu_adam_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      building 'deepspeed.ops.adagrad.cpu_adagrad_op' extension
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adagrad/cpu_adagrad.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/dropout_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include -fPIC -Icsrc/spatial/includes -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/spatial/csrc/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=spatial_inference_op -D_GLIBCXX_USE_CXX11_ABI=0
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda.cpp: In function 'at::Tensor lamb(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float)':
      csrc/lamb/fused_lamb_cuda.cpp:71:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         71 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:72:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         72 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:79:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         79 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:80:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         80 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:84:33: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         84 |         p.options().dtype(p.type().scalarType() == at::ScalarType::Half ? at::ScalarType::Float
            |                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      csrc/lamb/fused_lamb_cuda.cpp:85:81: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
         85 |                                                                         : p.type().scalarType()));
            |                                                                           ~~~~~~^~
      In file included from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                       from /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/extension.h:4,
                       from csrc/lamb/fused_lamb_cuda.cpp:6:
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:30: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            |                              ^~~~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(480): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(541): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(661): warning #177-D: variable "tid" was declared but never referenced
      
      csrc/transformer/dropout_kernels.cu(738): warning #177-D: variable "tid" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/pt_binding.cpp -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/lamb/fused_lamb_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 -DVERSION_GE_1_1 -DVERSION_GE_1_3 -DVERSION_GE_1_5 -lineinfo --use_fast_math -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=fused_lamb_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc -std=c++17
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/ds_transformer_cuda.cpp -o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o -O3 -std=c++17 -g -Wno-reorder -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/adam/cpu_adam_impl.cpp -o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o -O3 -std=c++17 -g -Wno-reorder -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcudart -lcublas -g -march=native -fopenmp -D__AVX256__ -D__ENABLE_CUDA__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adagrad_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/opt_bias_add.o build/temp.linux-x86_64-cpython-310/csrc/spatial/csrc/pt_binding.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/spatial/spatial_inference_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adagrad/cpu_adagrad_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/slice_attn_masks.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adagrad/cpu_adagrad.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/common/custom_cuda_kernel.cu -o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=cpu_adam_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/gelu_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/random_ltd/token_sort.cu -o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=random_ltd_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(358): warning #177-D: variable "threads" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=std::size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/qualified_name.h(73): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam_impl.o build/temp.linux-x86_64-cpython-310/csrc/common/custom_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lcurand -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/adam/cpu_adam_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/adam/cpu_adam.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/general_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu(41): warning #114-D: function "<unnamed>::error" was referenced but not defined
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/lamb/fused_lamb_cuda_kernel.cu: In function 'void fused_lamb_cuda(at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, at::Tensor&, float, float, float, float, float, float, float, int, int, int, float, at::Tensor&, at::Tensor&, at::Tensor&)':
      csrc/lamb/fused_lamb_cuda_kernel.cu:352:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        352 |     if (p.type().scalarType() == at::ScalarType::Double)
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:373:11: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        373 |     if (g.type().scalarType() == at::ScalarType::Half) {
            |     ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:375:58: warning: 'at::DeprecatedTypeProperties& at::Tensor::type() const' is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
        375 |         AT_ASSERTM(p.type().scalarType() == at::ScalarType::Float,
            |                                                    ~~~~~~^~
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:222:1: note: declared here
        222 |   DeprecatedTypeProperties & type() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1124: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1172: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1205: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1227: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1249: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1352: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1379: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:386: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:419: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:441: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:463: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:588: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:615: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:646: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:942: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:989: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1021: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1042: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1063: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1165: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1191: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:378: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:410: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:431: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:452: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:576: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:602: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:632: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:946: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:997: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1029: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1050: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1075: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1177: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:1203: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:163: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:189: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:339: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:390: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:422: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:443: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:468: warning: 'T* at::Tensor::data() const [with T = c10::Half]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:592: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:618: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:379:648: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        379 |         AT_DISPATCH_FLOATING_TYPES_AND_HALF(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1074: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1104: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1126: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1148: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1251: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1278: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:162: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:189: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:338: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:368: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:390: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:412: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                            ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:537: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:564: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:595: warning: 'T* at::Tensor::data() const [with T = double]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu: In lambda function:
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:893: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:922: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:943: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:964: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1066: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:1092: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:159: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                               ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:185: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                         ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:331: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                           ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:360: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:381: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                             ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:402: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:526: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:552: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      csrc/lamb/fused_lamb_cuda_kernel.cu:428:582: warning: 'T* at::Tensor::data() const [with T = float]' is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
        428 |         AT_DISPATCH_FLOATING_TYPES(
            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:244:1: note: declared here
        244 |   T * data() const {
            | ^ ~~
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda_kernel.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/lamb/fused_lamb_op.cpython-310-x86_64-linux-gnu.so
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/lamb/fused_lamb_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/random_ltd/gather_scatter.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/slice_attn_masks.o build/temp.linux-x86_64-cpython-310/csrc/random_ltd/token_sort.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/random_ltd_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/random_ltd/pt_binding.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/normalize_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      csrc/transformer/normalize_kernels.cu(1051): warning #177-D: variable "block_dim" was declared but never referenced
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/softmax_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -D__STOCHASTIC_MODE__ -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=stochastic_transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /soft/compilers/cudatoolkit/cuda-11.8.0/bin/nvcc -Icsrc/includes -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/TH -I/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/THC -I/soft/compilers/cudatoolkit/cuda-11.8.0/include -I/home/am6429/.conda/envs/dspeed_env/include/python3.10 -c csrc/transformer/transform_kernels.cu -o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O3 --use_fast_math -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_61 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_80,code=sm_80 -gencode=arch=compute_86,code=sm_86 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -DTORCH_EXTENSION_NAME=transformer_op -D_GLIBCXX_USE_CXX11_ABI=0 -ccbin /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-cc
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=false, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(77): here
      
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/util/irange.h(54): warning #186-D: pointless comparison of unsigned integer with zero
                detected during:
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator==(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      (61): here
                  instantiation of "__nv_bool c10::detail::integer_iterator<I, one_sided, <unnamed>>::operator!=(const c10::detail::integer_iterator<I, one_sided, <unnamed>> &) const [with I=size_t, one_sided=true, <unnamed>=0]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2327): here
                  instantiation of "__nv_bool c10::TensorImpl::SetDimsTemplate(c10::ArrayRef<T>) [with T=int64_t, <unnamed>=void]"
      /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/include/c10/core/TensorImpl.h(2337): here
      
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/stochastic_transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      /home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++ -shared -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,--allow-shlib-undefined -Wl,-rpath,/home/am6429/.conda/envs/dspeed_env/lib -Wl,-rpath-link,/home/am6429/.conda/envs/dspeed_env/lib -L/home/am6429/.conda/envs/dspeed_env/lib -L/soft/datascience/conda/2023-01-10/mconda3/lib/ -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/am6429/.conda/envs/dspeed_env/include -I/soft/datascience/conda/2023-01-10/mconda3/include/ -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/am6429/.conda/envs/dspeed_env/include build/temp.linux-x86_64-cpython-310/csrc/transformer/cublas_wrappers.o build/temp.linux-x86_64-cpython-310/csrc/transformer/dropout_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o build/temp.linux-x86_64-cpython-310/csrc/transformer/gelu_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/general_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/normalize_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/softmax_kernels.o build/temp.linux-x86_64-cpython-310/csrc/transformer/transform_kernels.o -L/home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages/torch/lib -L/soft/compilers/cudatoolkit/cuda-11.8.0/lib64 -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/deepspeed/ops/transformer/transformer_op.cpython-310-x86_64-linux-gnu.so -lcurand
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: build/temp.linux-x86_64-cpython-310/csrc/transformer/ds_transformer_cuda.o: relocation R_X86_64_TPOFF32 against hidden symbol `_ZZN8pybind116handle15inc_ref_counterEmE7counter' can not be used when making a shared object
      /home/am6429/.conda/envs/dspeed_env/bin/../lib/gcc/x86_64-conda-linux-gnu/11.4.0/../../../../x86_64-conda-linux-gnu/bin/ld: failed to set dynamic section sizes: bad value
      collect2: error: ld returned 1 exit status
      error: command '/home/am6429/.conda/envs/dspeed_env/bin/x86_64-conda-linux-gnu-c++' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed cleaning build dir for deepspeed
Failed to build deepspeed
ERROR: Could not build wheels for deepspeed, which is required to install pyproject.toml-based projects
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (3.1.0)
Requirement already satisfied: ninja in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.11.1)
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.26.0)
Requirement already satisfied: packaging>=20.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (23.1)
Requirement already satisfied: psutil in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Requirement already satisfied: tqdm in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.8.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+7bc01fdb-cp310-cp310-linux_x86_64.whl size=54574977 sha256=5140b38edf578a74c2896526acf5accaf8453620eaea873ce9b61b19f365b4c4
  Stored in directory: /var/tmp/pbs.1123124.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov/pip-ephem-wheel-cache-pw0ixb82/wheels/12/1d/ee/3780de8984f5774257085fe92ec89f10a6b1a5d2beabc12020
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+7bc01fdb
    Uninstalling deepspeed-0.10.4+7bc01fdb:
      Successfully uninstalled deepspeed-0.10.4+7bc01fdb
Successfully installed deepspeed-0.10.4+7bc01fdb
DEPRECATION: --build-option and --global-option are deprecated. pip 23.3 will enforce this behaviour change. A possible replacement is to use --config-settings. Discussion can be found at https://github.com/pypa/pip/issues/11859
WARNING: Implying --no-binary=:all: due to the presence of --build-option / --global-option. 
Processing /home/am6429/dl-io/DeepSpeed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: hjson in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (3.1.0)
Requirement already satisfied: ninja in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.11.1)
Requirement already satisfied: numpy in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.26.0)
Requirement already satisfied: packaging>=20.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (23.1)
Requirement already satisfied: psutil in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (5.9.5)
Requirement already satisfied: py-cpuinfo in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (9.0.0)
Requirement already satisfied: pydantic<2.0.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (1.10.13)
Requirement already satisfied: tqdm in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from deepspeed==0.10.4+7bc01fdb) (4.66.1)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/am6429/.conda/envs/dspeed_env/lib/python3.10/site-packages (from pydantic<2.0.0->deepspeed==0.10.4+7bc01fdb) (4.8.0)
Building wheels for collected packages: deepspeed
  Building wheel for deepspeed (setup.py): started
  Building wheel for deepspeed (setup.py): still running...
  Building wheel for deepspeed (setup.py): finished with status 'done'
  Created wheel for deepspeed: filename=deepspeed-0.10.4+7bc01fdb-cp310-cp310-linux_x86_64.whl size=57429894 sha256=7c493dd66106ba930a6ef61bac1276e24ac1fde9f2c8ed1a74732ad8399a60d1
  Stored in directory: /var/tmp/pbs.1123124.polaris-pbs-01.hsn.cm.polaris.alcf.anl.gov/pip-ephem-wheel-cache-3ajktudh/wheels/12/1d/ee/3780de8984f5774257085fe92ec89f10a6b1a5d2beabc12020
Successfully built deepspeed
Installing collected packages: deepspeed
  Attempting uninstall: deepspeed
    Found existing installation: deepspeed 0.10.4+7bc01fdb
    Uninstalling deepspeed-0.10.4+7bc01fdb:
      Successfully uninstalled deepspeed-0.10.4+7bc01fdb
Successfully installed deepspeed-0.10.4+7bc01fdb
